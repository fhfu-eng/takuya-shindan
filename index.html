<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>„Çø„ÇØ„Çø„Ç§„ÉóË®∫Êñ≠</title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700;900&family=Dela+Gothic+One&family=Kiwi+Maru:wght@500&display=swap" rel="stylesheet">

<style>
:root {
  --bg: #fff8f0;
  --white: #ffffff;
  --ink: #1a1a2e;
  --ink2: #555570;
  --red: #ff3f5b;
  --orange: #ff7b2e;
  --yellow: #ffd000;
  --green: #00c896;
  --blue: #3a7bff;
  --purple: #9b5de5;
  --pink: #ff5fa0;
  --card-shadow: 4px 4px 0px #1a1a2e;
  --card-shadow-lg: 6px 6px 0px #1a1a2e;
  --radius: 18px;
  --radius-sm: 12px;
}

* { box-sizing: border-box; margin: 0; padding: 0; }
html { scroll-behavior: smooth; }

body {
  background: var(--bg);
  font-family: 'Noto Sans JP', sans-serif;
  min-height: 100vh;
  color: var(--ink);
  overflow-x: hidden;
}

body::before {
  content: '';
  position: fixed;
  inset: 0;
  background-image: radial-gradient(circle, rgba(26,26,46,0.07) 1.5px, transparent 1.5px);
  background-size: 28px 28px;
  pointer-events: none;
  z-index: 0;
}

#app {
  position: relative;
  z-index: 1;
  max-width: 600px;
  margin: 0 auto;
  padding: 24px 20px 80px;
}

.screen { display: none; }
.screen.active {
  display: block;
  animation: popIn 0.4s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
}

@keyframes popIn {
  from { opacity: 0; transform: scale(0.94) translateY(12px); }
  to   { opacity: 1; transform: scale(1) translateY(0); }
}

.blob {
  position: fixed;
  border-radius: 50%;
  pointer-events: none;
  z-index: 0;
  filter: blur(60px);
  opacity: 0.35;
}
.blob-1 { width: 300px; height: 300px; background: #ff5fa0; top: -80px; right: -80px; animation: bm1 10s ease-in-out infinite; }
.blob-2 { width: 250px; height: 250px; background: #ffd000; bottom: 100px; left: -80px; animation: bm2 13s ease-in-out infinite; }
.blob-3 { width: 200px; height: 200px; background: #3a7bff; top: 40%; right: -60px; animation: bm3 9s ease-in-out infinite; }

@keyframes bm1 { 0%,100%{transform:translate(0,0)} 50%{transform:translate(-20px,30px)} }
@keyframes bm2 { 0%,100%{transform:translate(0,0)} 50%{transform:translate(30px,-20px)} }
@keyframes bm3 { 0%,100%{transform:translate(0,0)} 50%{transform:translate(-10px,40px)} }

/* ===== TOP ===== */
#screen-top { text-align: center; padding-top: 48px; }

.top-badge {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  background: var(--yellow);
  border: 2px solid var(--ink);
  border-radius: 50px;
  padding: 7px 18px;
  font-size: 12px;
  font-weight: 700;
  letter-spacing: 2px;
  margin-bottom: 28px;
  box-shadow: 3px 3px 0 var(--ink);
  animation: wiggle 3s ease-in-out infinite;
}

@keyframes wiggle {
  0%,100%{transform:rotate(-1deg)} 50%{transform:rotate(1deg)}
}

.main-title {
  font-family: 'Dela Gothic One', cursive;
  font-size: clamp(52px, 14vw, 82px);
  line-height: 0.95;
  letter-spacing: -2px;
  margin-bottom: 6px;
  color: var(--ink);
}
.main-title .line1 { color: var(--red); display: block; }
.main-title .line2 { color: var(--ink); display: block; font-size: 0.62em; letter-spacing: 4px; }

.title-sub {
  font-size: 14px;
  color: var(--ink2);
  letter-spacing: 3px;
  margin-bottom: 36px;
}

.char-showcase {
  display: flex;
  justify-content: center;
  align-items: flex-end;
  margin-bottom: 32px;
  height: 100px;
}

.char-bubble {
  width: 72px; height: 72px;
  border-radius: 50%;
  border: 3px solid var(--ink);
  display: flex; align-items: center; justify-content: center;
  font-size: 30px;
  box-shadow: var(--card-shadow);
  margin: 0 -5px;
  transition: transform 0.2s;
  background: var(--white);
  position: relative;
}
.char-bubble:nth-child(1) { background:#fff0f4; transform:rotate(-5deg) translateY(8px); }
.char-bubble:nth-child(2) { background:#f0f7ff; transform:rotate(3deg) translateY(-4px); z-index:1; width:88px; height:88px; font-size:36px; }
.char-bubble:nth-child(3) { background:#fffdf0; transform:rotate(-3deg) translateY(5px); }
.char-bubble:nth-child(4) { background:#f0fff8; transform:rotate(6deg) translateY(12px); }
.char-bubble:nth-child(5) { background:#f8f0ff; transform:rotate(-4deg) translateY(6px); }
.char-bubble:hover { transform:rotate(0deg) translateY(-8px) scale(1.1) !important; z-index:10; }

.intro-card {
  background: var(--white);
  border: 2px solid var(--ink);
  border-radius: var(--radius);
  padding: 20px 22px;
  margin-bottom: 28px;
  box-shadow: var(--card-shadow);
  text-align: left;
}
.intro-card p { font-size: 14px; line-height: 1.9; color: var(--ink2); }
.intro-card strong { color: var(--red); font-weight: 900; }

.btn-start {
  display: inline-flex;
  align-items: center;
  gap: 10px;
  background: var(--red);
  color: white;
  font-family: 'Dela Gothic One', cursive;
  font-size: 20px;
  letter-spacing: 4px;
  padding: 18px 48px;
  border: 2px solid var(--ink);
  border-radius: 50px;
  cursor: pointer;
  box-shadow: var(--card-shadow-lg);
  transition: all 0.15s ease;
  position: relative;
  overflow: hidden;
}
.btn-start::before {
  content: '';
  position: absolute;
  inset: 0;
  background: rgba(255,255,255,0.15);
  transform: translateX(-100%);
  transition: transform 0.3s ease;
}
.btn-start:hover { transform: translate(-3px,-3px); box-shadow: 9px 9px 0 var(--ink); }
.btn-start:hover::before { transform: translateX(0); }
.btn-start:active { transform: translate(0,0); box-shadow: 2px 2px 0 var(--ink); }

.type-count-row {
  margin-top: 16px;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
  font-size: 12px;
  color: var(--ink2);
  letter-spacing: 1px;
  flex-wrap: wrap;
}
.type-count-row span {
  display: inline-flex;
  align-items: center;
  gap: 5px;
  background: var(--white);
  border: 1.5px solid rgba(26,26,46,0.15);
  border-radius: 20px;
  padding: 5px 13px;
  font-weight: 700;
}

/* ===== QUIZ ===== */
#screen-quiz { padding-top: 8px; }

.quiz-header {
  display: flex;
  align-items: center;
  gap: 14px;
  margin-bottom: 28px;
}

.q-num-badge {
  flex-shrink: 0;
  background: var(--ink);
  color: var(--yellow);
  font-family: 'Dela Gothic One', cursive;
  font-size: 13px;
  padding: 7px 16px;
  border-radius: 50px;
  letter-spacing: 1px;
  white-space: nowrap;
}

.progress-track {
  flex: 1;
  height: 10px;
  background: rgba(26,26,46,0.1);
  border-radius: 5px;
  border: 1.5px solid rgba(26,26,46,0.15);
  overflow: hidden;
}
.progress-fill {
  height: 100%;
  background: linear-gradient(90deg, var(--red), var(--orange));
  border-radius: 5px;
  transition: width 0.5s cubic-bezier(0.4,0,0.2,1);
}

.q-card {
  background: var(--ink);
  border-radius: var(--radius);
  padding: 28px 24px;
  margin-bottom: 18px;
  position: relative;
  overflow: hidden;
}
.q-card::before {
  content: '';
  position: absolute;
  top: -30px; right: -30px;
  width: 120px; height: 120px;
  border-radius: 50%;
  background: rgba(255,255,255,0.04);
}
.q-num-label {
  font-family: 'Dela Gothic One', cursive;
  font-size: 11px;
  color: rgba(255,255,255,0.3);
  letter-spacing: 3px;
  margin-bottom: 10px;
}
.q-text-main {
  font-size: clamp(18px,4.5vw,22px);
  font-weight: 900;
  color: white;
  line-height: 1.55;
  margin-bottom: 10px;
}
.q-scenario {
  font-size: 12px;
  color: rgba(255,255,255,0.4);
  line-height: 1.6;
  border-top: 1px solid rgba(255,255,255,0.1);
  padding-top: 10px;
}

.options-list { display: flex; flex-direction: column; gap: 10px; }

.option-btn {
  width: 100%;
  background: var(--white);
  border: 2px solid var(--ink);
  border-radius: var(--radius-sm);
  padding: 15px 18px;
  cursor: pointer;
  transition: all 0.15s ease;
  box-shadow: var(--card-shadow);
  display: flex;
  align-items: flex-start;
  gap: 13px;
  text-align: left;
  font-family: 'Noto Sans JP', sans-serif;
  position: relative;
  overflow: hidden;
}
.option-btn::after {
  content: '';
  position: absolute;
  inset: 0;
  background: var(--yellow);
  opacity: 0;
  transition: opacity 0.15s;
  z-index: 0;
}
.option-btn:hover { transform: translate(-3px,-3px); box-shadow: 5px 5px 0 var(--ink); }
.option-btn:hover::after { opacity: 0.12; }
.option-btn:active { transform: translate(1px,1px); box-shadow: 1px 1px 0 var(--ink); }
.option-btn.selected { background: var(--yellow); transform: translate(-3px,-3px); box-shadow: 5px 5px 0 var(--ink); }

/* E option special */
.option-btn.opt-e {
  background: #fafafa;
  border-style: dashed;
  border-color: rgba(26,26,46,0.3);
}
.option-btn.opt-e:hover, .option-btn.opt-e.selected {
  background: #fff0f7;
  border-color: var(--pink);
  border-style: solid;
  box-shadow: 5px 5px 0 var(--pink);
}
.option-btn.opt-e:hover::after { background: var(--pink); opacity: 0.06; }

.opt-tag {
  position: relative; z-index: 1;
  flex-shrink: 0;
  width: 30px; height: 30px;
  background: var(--ink);
  color: white;
  border-radius: 8px;
  display: flex; align-items: center; justify-content: center;
  font-family: 'Dela Gothic One', cursive;
  font-size: 13px;
  transition: background 0.15s;
}
.option-btn.opt-e .opt-tag { background: var(--pink); }
.option-btn.selected .opt-tag { background: var(--red); }

.opt-text {
  position: relative; z-index: 1;
  font-size: 14px;
  font-weight: 700;
  line-height: 1.5;
  color: var(--ink);
  padding-top: 4px;
}
.option-btn.opt-e .opt-text { color: var(--ink2); font-style: italic; }

/* ===== LOADING ===== */
#screen-loading { text-align: center; padding: 80px 20px; }

.dot-row { display:flex; justify-content:center; gap:8px; margin-bottom:36px; }
.ldot {
  width: 16px; height: 16px; border-radius: 50%;
  animation: ldotBounce 1.2s ease-in-out infinite;
}
.ldot:nth-child(1){background:var(--red);animation-delay:0s}
.ldot:nth-child(2){background:var(--orange);animation-delay:.1s}
.ldot:nth-child(3){background:var(--yellow);animation-delay:.2s}
.ldot:nth-child(4){background:var(--green);animation-delay:.3s}
.ldot:nth-child(5){background:var(--blue);animation-delay:.4s}
.ldot:nth-child(6){background:var(--purple);animation-delay:.5s}
.ldot:nth-child(7){background:var(--pink);animation-delay:.6s}

@keyframes ldotBounce {
  0%,100%{transform:translateY(0) scale(1)}
  50%{transform:translateY(-20px) scale(1.2)}
}

.load-msg { font-family:'Dela Gothic One',cursive; font-size:18px; letter-spacing:3px; color:var(--ink2); }
.load-sub { margin-top:10px; font-size:13px; color:rgba(26,26,46,.35); letter-spacing:2px; }

/* ===== RESULT ===== */
#screen-result { padding-top: 8px; }

.result-eyebrow {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  margin-bottom: 20px;
  font-family: 'Dela Gothic One', cursive;
  font-size: 11px;
  letter-spacing: 4px;
  color: var(--ink2);
}
.result-eyebrow::before,.result-eyebrow::after {
  content:''; flex:1; height:1.5px; background:rgba(26,26,46,.15);
}

.result-main-card {
  background: var(--white);
  border: 3px solid var(--ink);
  border-radius: 24px;
  box-shadow: var(--card-shadow-lg);
  overflow: hidden;
  margin-bottom: 16px;
}

.result-card-header {
  background: var(--ink);
  padding: 28px 24px;
  text-align: center;
  position: relative;
  overflow: hidden;
}
.result-card-header::before {
  content:''; position:absolute; top:-50px; right:-50px;
  width:200px; height:200px; border-radius:50%; background:rgba(255,255,255,.04);
}

.result-img {
  width: 160px; height: 160px;
  object-fit: cover;
  border-radius: 50%;
  border: 4px solid rgba(255,255,255,0.25);
  margin: 0 auto 14px;
  display: block;
  animation: rBounce 1.5s cubic-bezier(0.34,1.56,0.64,1) forwards;
  transform: scale(0);
  box-shadow: 0 0 0 6px rgba(255,255,255,0.07);
}
@keyframes rBounce { to { transform: scale(1); } }

.rarity-row { display:flex; align-items:center; justify-content:center; gap:6px; margin-bottom:12px; }
.rarity-pill {
  background: rgba(255,255,255,.1);
  border: 1px solid rgba(255,255,255,.2);
  border-radius: 20px; padding: 4px 12px;
  font-size: 10px; color: rgba(255,255,255,.5); letter-spacing: 2px;
}
.rarity-stars { font-size:16px; letter-spacing:2px; }
.rarity-stars .s1 { color:var(--yellow); text-shadow:0 0 8px var(--yellow); }
.rarity-stars .s0 { color:rgba(255,255,255,.15); }

.result-intensity {
  font-family: 'Dela Gothic One', cursive;
  font-size: 13px; letter-spacing: 2px;
  color: rgba(255,255,255,.5); margin-bottom: 6px;
}
.result-name-big {
  font-family: 'Dela Gothic One', cursive;
  font-size: clamp(24px,7vw,34px);
  color: white; line-height: 1.2; letter-spacing: 1px;
}

.phrase-row {
  padding: 18px 22px;
  background: var(--yellow);
  border-bottom: 2px solid var(--ink);
  display: flex; align-items: center; gap: 10px;
}
.phrase-lbl { font-size:10px; font-weight:700; letter-spacing:3px; color:rgba(26,26,46,.5); white-space:nowrap; }
.phrase-txt { font-family:'Kiwi Maru',serif; font-size:17px; font-weight:500; color:var(--ink); }

.desc-wrap { padding: 22px 22px; }
.desc-title { font-size:10px; font-weight:700; letter-spacing:3px; color:var(--ink2); margin-bottom:10px; }
.desc-text { font-size:14px; line-height:1.95; color:var(--ink2); }

.score-wrap { padding: 0 22px 22px; }
.score-row { display:flex; justify-content:space-between; align-items:center; margin-bottom:8px; }
.score-title { font-size:10px; font-weight:700; letter-spacing:3px; color:var(--ink2); }
.score-pct { font-family:'Dela Gothic One',cursive; font-size:20px; color:var(--red); }
.score-track {
  height:12px;
  background:rgba(26,26,46,.08);
  border:1.5px solid rgba(26,26,46,.15);
  border-radius:6px; overflow:hidden;
}
.score-bar {
  height:100%;
  background:linear-gradient(90deg,var(--red),var(--orange));
  border-radius:6px; width:0;
  transition:width 1.2s cubic-bezier(0.4,0,0.2,1) 0.4s;
}

.mix-wrap { padding: 0 22px 22px; border-top:1px solid rgba(26,26,46,.08); padding-top:18px; }
.mix-title { font-size:10px; font-weight:700; letter-spacing:3px; color:var(--ink2); margin-bottom:12px; }
.mix-tags { display:flex; flex-wrap:wrap; gap:8px; }
.mix-tag {
  display:inline-flex; align-items:center; gap:5px;
  background:var(--bg); border:1.5px solid rgba(26,26,46,.15);
  border-radius:20px; padding:5px 13px;
  font-size:13px; font-weight:700; color:var(--ink2);
}

.action-row { display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-top:14px; }

.btn-retry {
  background:var(--white); border:2px solid var(--ink); border-radius:50px;
  padding:15px; font-family:'Dela Gothic One',cursive; font-size:14px;
  letter-spacing:2px; color:var(--ink); cursor:pointer;
  box-shadow:var(--card-shadow); transition:all .15s; text-align:center;
}
.btn-retry:hover { transform:translate(-2px,-2px); box-shadow:5px 5px 0 var(--ink); }

.btn-share {
  background:var(--blue); border:2px solid var(--ink); border-radius:50px;
  padding:15px; font-family:'Dela Gothic One',cursive; font-size:14px;
  letter-spacing:2px; color:white; cursor:pointer;
  box-shadow:var(--card-shadow); transition:all .15s; text-align:center;
}
.btn-share:hover { transform:translate(-2px,-2px); box-shadow:5px 5px 0 var(--ink); background:#2260ee; }

/* ===== ALL TYPES ===== */
#screen-all { padding-top: 8px; }

.back-btn {
  display:inline-flex; align-items:center; gap:6px;
  background:none; border:1.5px solid rgba(26,26,46,.2); border-radius:50px;
  padding:8px 18px; font-size:13px; font-weight:700; color:var(--ink2);
  cursor:pointer; margin-bottom:22px; transition:all .15s;
  font-family:'Noto Sans JP',sans-serif;
}
.back-btn:hover { background:var(--white); border-color:var(--ink); color:var(--ink); box-shadow:var(--card-shadow); }

.all-header { margin-bottom:24px; }
.all-header h2 { font-family:'Dela Gothic One',cursive; font-size:28px; margin-bottom:4px; }
.all-header p { font-size:13px; color:var(--ink2); }

.all-grid { display:grid; grid-template-columns:repeat(2,1fr); gap:10px; }

.type-card {
  background:var(--white); border:2px solid var(--ink);
  border-radius:var(--radius-sm); padding:14px 15px;
  box-shadow:3px 3px 0 var(--ink); transition:all .15s; cursor:default;
}
.type-card:hover { transform:translate(-2px,-2px); box-shadow:5px 5px 0 var(--ink); }

.tc-top { display:flex; align-items:center; justify-content:space-between; margin-bottom:8px; }
.tc-icon { font-size:26px; }
.tc-rarity { font-size:10px; color:var(--yellow); letter-spacing:1px; }
.tc-name { font-size:13px; font-weight:900; line-height:1.3; margin-bottom:5px; }
.tc-phrase { font-family:'Kiwi Maru',serif; font-size:11px; color:var(--ink2); border-top:1px solid rgba(26,26,46,.08); padding-top:6px; }

/* footer */
.footer-nav { text-align:center; margin-top:32px; padding-top:24px; border-top:1.5px dashed rgba(26,26,46,.12); }
.footer-link {
  display:inline-flex; align-items:center; gap:6px;
  background:none; border:none; font-size:13px;
  font-family:'Noto Sans JP',sans-serif; font-weight:700;
  color:var(--ink2); cursor:pointer; letter-spacing:2px;
  text-decoration:underline; text-underline-offset:4px; transition:color .15s;
}
.footer-link:hover { color:var(--red); }

/* Toast */
.toast {
  position:fixed; bottom:30px; left:50%;
  transform:translateX(-50%) translateY(80px);
  background:var(--ink); color:var(--yellow);
  font-weight:700; font-size:14px;
  padding:12px 28px; border-radius:50px;
  z-index:999; transition:transform .35s cubic-bezier(0.34,1.56,0.64,1);
  white-space:nowrap; letter-spacing:1px;
}
.toast.show { transform:translateX(-50%) translateY(0); }

@media (max-width:440px) {
  .all-grid { grid-template-columns:1fr 1fr; }
  .q-card { padding:22px 18px; }
  .btn-start { padding:16px 36px; font-size:18px; }
}
</style>
</head>
<body>

<div class="blob blob-1"></div>
<div class="blob blob-2"></div>
<div class="blob blob-3"></div>

<div id="app">

  <!-- TOP -->
  <div id="screen-top" class="screen active">
    <div class="top-badge">üîç PERSONALITY QUIZ</div>
    <h1 class="main-title">
      <span class="line1">„Çø„ÇØ„Çø„Ç§„Éó</span>
      <span class="line2">Ë®∫Êñ≠</span>
    </h1>
    <p class="title-sub">„ÅÇ„Å™„Åü„ÅÆ‰∏≠„ÅÆ„Çø„ÇØ„É§„ÇíÊö¥„Åè</p>

    <div class="char-showcase">
      <div class="char-bubble">üò§</div>
      <div class="char-bubble">üåô</div>
      <div class="char-bubble">üîç</div>
      <div class="char-bubble">üêπ</div>
      <div class="char-bubble">üëÅÔ∏è</div>
    </div>

    <div class="intro-card">
      <p>„ÅÇ„Å™„Åü„ÅÆÊÅãÊÑõË°åÂãï„Å´„ÅØ„ÄÅÂøÖ„Åö<strong>„Äå„Çø„ÇØ„É§„Äç</strong>„ÅåÊΩú„Çì„Åß„ÅÑ„Çã„ÄÇ<br>10Âïè„ÅÆË≥™Âïè„Åß„ÄÅ„ÅÇ„Å™„Åü„ÅÆÊú¨Ë≥™ÁöÑ„Å™„Çø„ÇØ„É§„Çø„Ç§„Éó„ÇíË®∫Êñ≠„Åó„Åæ„Åô„ÄÇ<br>ÂÖ®<strong>16„Çø„Ç§„Éó</strong>„ÄÅ„Åï„Å¶„Å©„ÅÆ„Çø„ÇØ„É§„ÅåÁõÆË¶ö„ÇÅ„Çã„ÅãÔºü</p>
    </div>

    <button class="btn-start" onclick="startQuiz()">Ë®∫Êñ≠„Çπ„Çø„Éº„Éà ‚Üí</button>

    <div class="type-count-row">
      <span>üìã ÂÖ®10Âïè</span>
      <span>üé≠ 16„Çø„Ç§„Éó</span>
      <span>‚è± Á¥Ñ2ÂàÜ</span>
    </div>

    <div class="footer-nav">
      <button class="footer-link" onclick="showAllTypes()">ÂÖ®„Çø„Ç§„Éó„ÇíË¶ã„Çã ‚Üí</button>
    </div>
  </div>

  <!-- QUIZ -->
  <div id="screen-quiz" class="screen">
    <div class="quiz-header">
      <div class="q-num-badge" id="q-counter">Q 01 / 10</div>
      <div class="progress-track">
        <div class="progress-fill" id="progress-fill" style="width:0%"></div>
      </div>
    </div>
    <div class="q-card">
      <div class="q-num-label" id="q-num-label">QUESTION 01</div>
      <p class="q-text-main" id="q-text"></p>
      <p class="q-scenario" id="q-scenario"></p>
    </div>
    <div class="options-list" id="options-list"></div>
  </div>

  <!-- LOADING -->
  <div id="screen-loading" class="screen">
    <div class="dot-row">
      <div class="ldot"></div><div class="ldot"></div><div class="ldot"></div>
      <div class="ldot"></div><div class="ldot"></div><div class="ldot"></div>
      <div class="ldot"></div>
    </div>
    <p class="load-msg">„Çø„ÇØ„É§ÊàêÂàÜ„ÇíÂàÜÊûê‰∏≠‚Ä¶</p>
    <p class="load-sub">ANALYZING YOUR TAKUYA DNA</p>
  </div>

  <!-- RESULT -->
  <div id="screen-result" class="screen">
    <div class="result-eyebrow">YOUR RESULT</div>
    <div class="result-main-card">
      <div class="result-card-header">
        <img class="result-img" id="result-img" src="" alt="">
        <div class="rarity-row">
          <span class="rarity-pill">RARITY</span>
          <span class="rarity-stars" id="result-stars"></span>
        </div>
        <div class="result-intensity" id="result-intensity"></div>
        <div class="result-name-big" id="result-name"></div>
      </div>
      <div class="phrase-row">
        <span class="phrase-lbl">Âè£Áôñ</span>
        <span class="phrase-txt" id="result-phrase"></span>
      </div>
      <div class="desc-wrap">
        <div class="desc-title">CHARACTER DESCRIPTION</div>
        <p class="desc-text" id="result-desc"></p>
      </div>
      <div class="score-wrap">
        <div class="score-row">
          <span class="score-title">DOMINANT SCORE</span>
          <span class="score-pct" id="score-pct">‚Äì%</span>
        </div>
        <div class="score-track"><div class="score-bar" id="score-bar"></div></div>
      </div>
      <div class="mix-wrap" id="mix-wrap"></div>
    </div>
    <div class="action-row">
      <button class="btn-retry" onclick="retryQuiz()">„ÇÇ„ÅÜ‰∏ÄÂ∫¶</button>
      <button class="btn-share" onclick="shareResult()">„Ç∑„Çß„Ç¢„Åô„Çã</button>
    </div>
    <div class="footer-nav">
      <button class="footer-link" onclick="showAllTypes()">ÂÖ®„Çø„Ç§„Éó„ÇíË¶ã„Çã ‚Üí</button>
    </div>
  </div>

  <!-- ALL TYPES -->
  <div id="screen-all" class="screen">
    <button class="back-btn" onclick="goBack()">‚Üê Êàª„Çã</button>
    <div class="all-header">
      <h2>ÂÖ®16„Çø„ÇØ„É§„Çø„Ç§„Éó</h2>
      <p>„ÅÇ„Å™„Åü„ÅØ„Å©„ÅÆ„Çø„ÇØ„É§Ôºü</p>
    </div>
    <div class="all-grid" id="all-grid"></div>
  </div>

</div>

<div class="toast" id="toast"></div>

<script>
// ==============================
// TYPE DATA
// ==============================
const TYPES = {
  wakaranai: { name:'„Çè„Åã„Çì„Å™„ÅÑ„Çø„ÇØ„É§',      icon:'ü§î', img:'wakaranai.jpg',   rarity:3, phrase:'„Äå„Åæ„Å†„Çè„Åã„Çì„Å™„ÅÑ„Äç',             desc:'Èñ¢‰øÇ„ÇíÊòéÁ¢∫Âåñ„Åô„ÇãÂ±ÄÈù¢„Å´„Å™„Çã„Å®Âà§Êñ≠„Çí‰øùÁïô„Åó„ÄÅ„Äå„Åæ„Å†„Çè„Åã„Çâ„Å™„ÅÑ„Äç„Å®„ÅÑ„ÅÜ‰ΩôÁôΩ„Å´Ë∫´„ÇíÁΩÆ„Åì„ÅÜ„Å®„Åô„Çã„Çø„Ç§„Éó„ÄÇÈÅ∏„Å∞„Çå„Å™„ÅÑ„Å®„ÅÑ„ÅÜÁ¢∫ÂÆöÁöÑ„Å™Áóõ„Åø„ÇíÂõûÈÅø„Åô„Çã„Åü„ÇÅ„ÄÅÊõñÊòß„Åï„ÅÆ‰∏≠„ÅßÂèØËÉΩÊÄß„ÇíÂª∂ÂëΩ„Åô„ÇãÂÇæÂêë„Åå„ÅÇ„Çã„ÄÇ‰∏ª‰ΩìÁöÑ„Å´Ê±∫„ÇÅ„Å™„ÅÑ„Åì„Å®„ÅßÂ§±ÊïóË≤¨‰ªª„ÇíËÉåË≤†„Çè„Åö„Å´Ê∏à„ÇÄ‰∏ÄÊñπ„ÄÅÁõ∏Êâã„Åã„Çâ„ÅØÊ∏©Â∫¶„ÅÆË¶ã„Åà„Å™„ÅÑÂ≠òÂú®„Å´„Å™„Çä„ÇÑ„Åô„ÅÑ„ÄÇÊÅãÊÑõ„Å´„Åä„ÅÑ„Å¶„ÅØ"ÈÄ≤„Åæ„Å™„ÅÑÂÆâÂøÉ"„ÇíÈÅ∏„Å≥„Åå„Å°„ÄÇ' },
  udegumi:   { name:'ËÖïÁµÑ„ÇÄ„Å™„Çø„ÇØ„É§',         icon:'üí™', img:'udegumi.jpg',     rarity:4, phrase:'„Äå„ÅÑ„ÇÑÈÅï„Åè„Å¶„Äç',                desc:'Ëá™Â∞äÂøÉ„ÅÆÈò≤Ë°õ„ÇíÊúÄÂÑ™ÂÖà„Åó„ÄÅÂ•ΩÊÑè„ÅÆË°®Êòé„Çí‰∏ªÂ∞éÊ®©„ÅÆÂñ™Â§±„Å®Êçâ„Åà„Åå„Å°„Å™ÂØæÊäóÂßøÂã¢Âûã„ÄÇÁêÜÂ±à„ÇÑÂÜ∑Èùô„Åï„ÇíÁõæ„Å´„Åó„Å™„Åå„ÇâÊÑüÊÉÖ„ÇíÊäëÂà∂„Åó„ÄÅÂÑ™‰Ωç„Å™Á´ãÂ†¥„Çí‰øù„Å®„ÅÜ„Å®„Åô„ÇãÂÇæÂêë„Åå„ÅÇ„Çã„ÄÇÊú¨Èü≥„ÇíË¶ã„Åõ„Å™„ÅÑ„Åì„Å®„ÅßÂÇ∑„Å§„Åè„É™„Çπ„ÇØ„Çí‰∏ã„Åí„Å¶„ÅÑ„Çã„Åå„ÄÅ„Åù„ÅÆÁ°¨Áõ¥„Åó„ÅüÂßøÂã¢„ÅåË¶™ÂØÜÂåñ„ÅÆÊ©ü‰ºö„ÇíÈÅ†„Åñ„Åë„Çã„Åì„Å®„ÇÇÂ∞ë„Å™„Åè„Å™„ÅÑ„ÄÇÊÑõÊÉÖ„Çà„Çä„ÇÇ‰ΩìÈù¢„ÇíÂÆà„ÇãÈÅ∏Êäû„ÇíÂèñ„Çä„ÇÑ„Åô„ÅÑ„ÄÇ' },
  poemer:    { name:'„Éù„Ç®„Éû„Éº„Çø„ÇØ„É§',          icon:'üåô', img:'poemer.jpg',      rarity:3, phrase:'„Äå„ÅÇ„ÅÆÂ§ú„ÅØÊ∞∏ÈÅ†„Å†„Å£„Åü„Äç',       desc:'ÊÅãÊÑõ‰ΩìÈ®ì„ÇíÂèôÊÉÖÁöÑ„Å™Áâ©Ë™û„Å∏„Å®ÂÜçÊßãÁØâ„Åô„ÇãÁæéÂåñÂûã„ÄÇÈñ¢‰øÇ„Åù„ÅÆ„ÇÇ„ÅÆ„Çà„Çä„ÇÇ„ÄÅ„Åù„Åì„Åã„ÇâÁîü„Åæ„Çå„ÇãÊÑèÂë≥„ÇÑË±°Âæ¥ÊÄß„ÇíÈáçË¶ñ„Åô„ÇãÂÇæÂêë„ÅåÂº∑„ÅÑ„ÄÇÂ§±ÊÅã„ÇÑÊõñÊòß„Å™Èñ¢‰øÇ„Åï„Åà„ÇÇ"ÈÅãÂëΩ„ÅÆ‰∏ÄÁ´†"„Å®„Åó„Å¶Ë™û„ÇäÁõ¥„Åô„Åì„Å®„Åß„ÄÅÊú™Á∑¥„ÇÑÁóõ„Åø„ÇíËä∏Ë°ìÁöÑ‰æ°ÂÄ§„Å∏Ëª¢Êèõ„Åô„Çã„ÄÇÊÑüÊÉÖ„ÅÆË®ÄË™ûÂåñËÉΩÂäõ„ÅØÈ´ò„ÅÑ„Åå„ÄÅÁèæÂÆü„ÅÆÈñ¢‰øÇÊîπÂñÑ„Çà„Çä„ÇÇÁâ©Ë™û„ÅÆÂÆåÊàêÂ∫¶„ÇíÂÑ™ÂÖà„Åó„ÇÑ„Åô„ÅÑ„ÄÇ' },
  jobhopper: { name:'„Ç∏„Éß„Éñ„Éõ„ÉÉ„Éë„Éº„Çø„ÇØ„É§',   icon:'üöÄ', img:'jobhopper.jpg',   rarity:4, phrase:'„Äå‰ªä„Éï„Çß„Éº„Ç∫Â§â„Çè„Å£„Å¶„Å¶„Äç',     desc:'ÁèæÂú®„ÅÆÊú™ÂÆåÊàê„Åï„Çí„ÄåÈÅéÊ∏°Êúü„Äç„Å®ÂÆöÁæ©„Åó„ÄÅÂ∏∏„Å´Ê¨°„ÅÆ„Çπ„ÉÜ„Éº„Ç∏„ÇíË™û„ÇãÂèØËÉΩÊÄßÂÅèÈáçÂûã„ÄÇÊÅãÊÑõ„Å´„Åä„ÅÑ„Å¶„ÇÇ"‰ªä„ÅØÊ∫ñÂÇôÊÆµÈöé"„Å®„ÅÑ„ÅÜÁâ©Ë™û„ÇíË®≠ÂÆö„Åó„ÄÅÂÆâÂÆö„ÇÑË≤¨‰ªª„Çà„ÇäÊú™Êù•„ÅÆ‰º∏„Å≥„Åó„Çç„ÇíÂº∑Ë™ø„Åô„ÇãÂÇæÂêë„Åå„ÅÇ„Çã„ÄÇÁêÜÊÉ≥ÂÉè„Å∏„ÅÆÁßªË°å„ÇíÁπ∞„ÇäËøî„Åô„Åå„ÄÅË∂≥Â†¥„ÅåÂÆö„Åæ„Çâ„Å™„ÅÑ„Åæ„ÅæÈñ¢‰øÇ„ÇíÁØâ„Åì„ÅÜ„Å®„Åô„Çã„Åü„ÇÅ„ÄÅÁõ∏Êâã„Å´‰∏çÂÆâÂÆö„Åï„ÇíÊÑü„Åò„Åï„Åõ„Çã„Åì„Å®„ÇÇÂ§ö„ÅÑ„ÄÇ' },
  hamchan:   { name:'„Éè„É†„Å°„ÇÉ„Çì„Åö„Çø„ÇØ„É§',     icon:'üêπ', img:'hamchan.jpg',     rarity:3, phrase:'„Äå„Çø„ÇØ„É§ÂÇ∑„Å§„ÅÑ„Å°„ÇÉ„ÅÜ„ÇàÔºü„Äç', desc:'Âº±„Åï„ÇÑÁÑ°Âû¢„Åï„ÇíÂâçÈù¢„Å´Âá∫„Åó„ÄÅÂÆà„Çâ„Çå„ÇãÁ´ãÂ†¥„ÇíÁ¢∫‰øù„Åó„Å™„Åå„ÇâÊâøË™ç„ÇíÊ±Ç„ÇÅ„ÇãÁîòÂèóÂûã„ÄÇÂ∞èÂãïÁâ©ÁöÑ„Å™ÊåØ„ÇãËàû„ÅÑ„ÅßÊîªÊíÉÊÄß„ÇíÈö†„Åô„Åå„ÄÅÂÜÖÈù¢„Å´„ÅØÂº∑„ÅÑÊØîËºÉÊÑèË≠ò„ÇÑÂ´âÂ¶¨ÂøÉ„ÇíÊä±„Åà„Çã„Åì„Å®„ÇÇ„ÅÇ„Çã„ÄÇË¢´ÂÆ≥ËÄÖ„Éù„Ç∏„Ç∑„Éß„É≥„Å´Á´ã„Å§„Åì„Å®„ÅßÂÑ™‰ΩçÊÄß„Çí‰øù„Å®„ÅÜ„Å®„Åô„ÇãÂÅ¥Èù¢„Åå„ÅÇ„Çä„ÄÅÁÑ°Ëá™Ë¶ö„ÅÆ‰æùÂ≠ò„Å®Á´∂‰∫â„ÇíÂêåÊôÇ„Å´Ë°å„ÅÜË§áÈõë„Å™„É©„Éñ„Çπ„Çø„Ç§„É´„ÄÇ' },
  atfield:   { name:'AT„Éï„Ç£„Éº„É´„ÉâËß£Èô§„Çø„ÇØ„É§', icon:'‚ö°', img:'atfield.png',     rarity:5, phrase:'„Äå‰ø∫„Åï„ÄÅÂÆü„ÅØ‚Ä¶„Äç',            desc:'Êó•Â∏∏„Åß„ÅØÊÑüÊÉÖ„ÇíÊäëÂà∂„ÅóÁêÜÊÄßÁöÑ„Å´ÊåØ„ÇãËàû„ÅÜ„Åå„ÄÅ‰∏ÄÂÆö„ÅÆÊù°‰ª∂‰∏ã„Åß‰∏ÄÊ∞ó„Å´Ëá™Â∑±ÈñãÁ§∫„Åô„ÇãÂë®ÊúüÁàÜÁô∫Âûã„ÄÇÊäëÂúß„Å®Ëß£Êîæ„ÅÆÊåØÂπÖ„ÅåÂ§ß„Åç„Åè„ÄÅÊÄ•ÊøÄ„Å™Ë∑ùÈõ¢„ÅÆÊé•Ëøë„ÇíÂºï„ÅçËµ∑„Åì„Åô„Åì„Å®„Åå„ÅÇ„Çã„ÄÇÊôÆÊÆµ„ÅÆÂÜ∑Èùô„Åï„Å®„ÅÆ„ÇÆ„É£„ÉÉ„Éó„ÅØÈ≠ÖÂäõ„Å´„ÇÇ„Å™„Çã„Åå„ÄÅÁõ∏Êâã„Åã„Çâ„ÅØÊÉÖÁ∑í„ÅÆË™≠„Åø„Å´„Åè„ÅÑÂ≠òÂú®„Å´„Å™„Çä„ÇÑ„Åô„ÅÑ„ÄÇÂÆâÂÆö„Çà„Çä„ÇÇËá®ÁïåÁÇπ„ÅßÂãï„ÅèÊÅãÊÑõÂÇæÂêë„ÄÇ' },
  jyurei:    { name:'Âë™Èúä„Çø„ÇØ„É§',             icon:'üëÅÔ∏è', img:'jyurei.jpg',      rarity:5, phrase:'„Äå„Åµ„Éº„Çì„Äç',                  desc:'ÈÅ∏„Å∞„Çå„Å™„Åã„Å£„ÅüÁµåÈ®ì„ÇíÂº∑„ÅèÂÜÖÂú®Âåñ„Åó„ÄÅÊØîËºÉ„ÇÑË¶≥ÂØü„ÇíÈÄö„Åó„Å¶Èùô„Åã„Å™Â´âÂ¶¨„ÇíËìÑÁ©ç„Åô„ÇãÂü∑ÁùÄÂûã„ÄÇË°®Èù¢‰∏ä„ÅØÂπ≥Èùô„ÇíË£Ö„ÅÜ„Åå„ÄÅ‰ªñËÄÖ„ÅÆÂπ∏Á¶è„ÇÑÂÑ™‰Ωç„Å´ÊïèÊÑü„Å´ÂèçÂøú„Åô„Çã„ÄÇÁõ¥Êé•ÁöÑ„Å™ÊîªÊíÉÊÄß„ÅØ‰Ωé„ÅÑ„ÇÇ„ÅÆ„ÅÆ„ÄÅÈáç„Åü„ÅÑÁ©∫Ê∞ó„ÇÑÂúßÂäõ„Å®„Åó„Å¶Èñ¢‰øÇ„Å´ÂΩ±Èüø„Çí‰∏é„Åà„Çã„Åì„Å®„Åå„ÅÇ„Çã„ÄÇÊÅãÊÑõ„Çí"Ë®ºÊòé„ÅÆÂ†¥"„Å®„Åó„Å¶ÂÜçÊåëÊà¶„ÅóÁ∂ö„Åë„ÇãÂÇæÂêë„ÄÇ' },
  unko:      { name:'„ÅÜ„Çì„Åì„Çø„ÇØ„É§',           icon:'üí©', img:'unko.png',        rarity:4, phrase:'„Äå„Å©„ÅÜ„Åõ‰ø∫„ÅØ„ÅÜ„Çì„Åì„Äç',        desc:'Ëá™Â∑±Âçë‰∏ã„ÇíÂÖàÂõû„Çä„ÅßÊèêÁ§∫„Åô„Çã„Åì„Å®„ÅßÊãíÁµ∂„É™„Çπ„ÇØ„Çí‰∏ã„Åí„Çà„ÅÜ„Å®„Åô„ÇãÈò≤Âæ°Âûã„ÄÇËá™ÂàÜ„Çí‰∏ã„Åí„ÇãÁô∫Ë®Ä„ÇíÁπ∞„ÇäËøî„Åô„Åå„ÄÅ„Åù„ÅÆÊ†πÂ∫ï„Å´„ÅØÂº∑„ÅÑÊâøË™çÊ¨≤Ê±Ç„Åå„ÅÇ„Çã„ÄÇÂêåÊÉÖ„ÇÑÂÆâÂøÉÊÑü„ÇíÂºï„ÅçÂá∫„Åô‰∏ÄÊñπ„ÄÅÈÅéÂ∫¶„Å™Ëá™Â∑±Âê¶ÂÆö„ÅåÈñ¢‰øÇ„ÅÆÈáç„Åï„Å´„Å§„Å™„Åå„Çã„Åì„Å®„ÇÇ„ÄÇÂê¶ÂÆöÁöÑËá™Â∑±ÂÉè„ÇíÂà©Áî®„Åó„Å§„Å§„ÄÅÊú¨ÂΩì„ÅØË©ï‰æ°„ÇíÂàáÊúõ„Åó„Å¶„ÅÑ„Çã‰∫åÂ±§ÊßãÈÄ†„Çø„Ç§„Éó„ÄÇ' },
  mutation:  { name:'Á™ÅÁÑ∂Â§âÁï∞„Çø„ÇØ„É§',         icon:'üß¨', img:'mutation.jpg',    rarity:5, phrase:'„Äå‰ø∫„Åì„Çì„Å™„Çì„Å†„Å£„ÅëÔºü„Äç',      desc:'ÁâπÂÆö„ÅÆÊÅãÊÑõÂØæË±°„ÅåÂá∫Áèæ„Åó„ÅüÁû¨Èñì„Å´‰∫∫Ê†ºÁâπÊÄß„ÅåÊÄ•ÊøÄ„Å´Â§âÂåñ„Åô„ÇãÈÅ©ÂøúÊö¥Ëµ∞Âûã„ÄÇÊôÆÊÆµ„ÅØÁêÜÊÄßÁöÑ„Åß„ÇÇ„ÄÅÊÅãÊÑõ‰∏ã„Åß„ÅØ‰æ°ÂÄ§Ë¶≥„ÉªÁîüÊ¥ª„É™„Ç∫„É†„ÉªË®ÄÂãï„Åæ„ÅßÊõ∏„ÅçÊèõ„Çè„Çã„ÄÇÁí∞Â¢ÉÈÅ©ÂøúËÉΩÂäõ„ÅØÈ´ò„ÅÑ„Åå„ÄÅËá™Â∑±Âêå‰∏ÄÊÄß„Åå‰∏çÂÆâÂÆö„Å´„Å™„Çä„ÇÑ„Åô„ÅÑ„ÄÇÁõ∏Êâã„Å´ÊúÄÈÅ©Âåñ„ÅóÁ∂ö„Åë„ÅüÁµêÊûú„ÄÅ„ÄåÊú¨Êù•„ÅÆËá™ÂàÜ„Äç„ÅåÂ∏åËñÑÂåñ„Åô„ÇãÂç±Èô∫„ÇÇÂ≠ï„ÇÄ„ÄÇÊÅã„ÅØÈÄ≤Âåñ„Åß„ÇÇ„ÅÇ„Çä„ÄÅÂ§âÁï∞„Åß„ÇÇ„ÅÇ„Çã„Å®‰ΩìÁèæ„Åô„Çã„Çø„Ç§„Éó„ÄÇ' },
  shoninbaku:{ name:'ÊâøË™çÁàÜÈ£ü„Çø„ÇØ„É§',         icon:'üì±', img:'shoninbaku.jpg',  rarity:4, phrase:'„Äå‰ªä„Å™„Çì„ÅãÂÜ∑„Åü„Åè„Å™„ÅÑÔºü„Äç',    desc:'Â•ΩÊÑè„ÉªË≥ûË≥õ„Éª„É™„Ç¢„ÇØ„Ç∑„Éß„É≥„ÇíÊ†ÑÈ§äÊ∫ê„Å®„Åó„Å¶Ê©üËÉΩ„Åô„ÇãÂ§ñÈÉ®‰æùÂ≠òÂûã„ÄÇËøî‰ø°ÈÄüÂ∫¶„ÇÑÊó¢Ë™≠„Çø„Ç§„Éü„É≥„Ç∞„Å´Âº∑„ÅèÂΩ±Èüø„Åï„Çå„ÄÅË©ï‰æ°„ÅÆÊè∫„Çâ„Åé„Åå„Åù„ÅÆ„Åæ„ÅæËá™Â∑±‰æ°ÂÄ§„ÅÆÊè∫„Çå„Å∏Áõ¥Áµê„Åô„Çã„ÄÇÊÑõÊÉÖ„Åù„ÅÆ„ÇÇ„ÅÆ„Çà„Çä"ÊÑõ„Åï„Çå„Å¶„ÅÑ„ÇãË®ºÊã†"„ÇíÈáçË¶ñ„Åô„ÇãÂÇæÂêë„Åå„ÅÇ„Çä„ÄÅÈñ¢‰øÇ„ÅÆÊ∏©Â∫¶ÁÆ°ÁêÜ„Å´Á•ûÁµå„ÇíÊ∂àËÄó„Åô„Çã„ÄÇÊâøË™ç„ÅåÊ≠¢„Åæ„Çã„Å®ÊÄ•ÈÄü„Å´‰∏çÂÆâÂÆöÂåñ„Åô„Çã„ÄÇ' },
  risou:     { name:'ÁêÜÊÉ≥ÈÅéÁ©çËºâ„Çø„ÇØ„É§',       icon:'üèîÔ∏è', img:'risou.jpg',       rarity:3, phrase:'„Äå„Å™„Çì„ÅãÈÅï„Å£„Åü„Åã„ÇÇ„Äç',        desc:'ÊÅãÊÑõÂØæË±°„Å´ÈÅéÂâ∞„Å™ÁêÜÊÉ≥ÂÉè„ÇíÊäïÂΩ±„Åô„ÇãÊúüÂæÖËÇ•Â§ßÂûã„ÄÇÁõ∏Êâã„ÅÆÂÆüÂÉè„Çà„Çä„ÇÇ„ÄÅËá™ÂàÜ„ÅåÊúõ„ÇÄÁâ©Ë™ûÊßãÈÄ†„ÇíÂÑ™ÂÖà„Åó„ÇÑ„Åô„ÅÑ„ÄÇÂàùÊúüÊÆµÈöé„Åß„ÅØÁÜ±Èáè„ÅåÈ´ò„ÅÑ„Åå„ÄÅÁèæÂÆü„Å®„ÅÆË™§Â∑Æ„ÅåÈ°ïÂú®Âåñ„Åô„Çã„Å®ÊÄ•ÊøÄ„Å´ÁÜ±„ÅåÂÜ∑„ÇÅ„Çã„ÄÇÁêÜÊÉ≥„ÇíÊä±„ÅèËÉΩÂäõ„ÅØÈ´ò„ÅÑ„Åå„ÄÅÁ≠âË∫´Â§ß„ÅÆÈñ¢‰øÇ„ÇíÁ∂≠ÊåÅ„Åô„ÇãÊåÅ‰πÖÂäõ„Å´Ë™≤È°å„Åå„ÅÇ„Çã„ÄÇÊÅã„Çí"ÂÆåÊàêÂõ≥"„ÅßË¶ã„Åå„Å°„ÄÇ' },
  hikaku:    { name:'ÊØîËºÉÁÑ°Èôê„É´„Éº„Éó„Çø„ÇØ„É§',   icon:'üîÑ', img:'hikaku.jpg',      rarity:4, phrase:'„Äå„ÅÇ„ÅÑ„Å§„Å´„ÅØÂãù„Å£„Å¶„Çã„Çà„Å™Ôºü„Äç',desc:'‰ªñËÄÖ„Å®„ÅÆÊØîËºÉ„ÇíÈÄö„Åò„Å¶Ëá™Â∑±‰ΩçÁΩÆ„ÇíÊ∏¨ÂÆö„ÅóÁ∂ö„Åë„ÇãÁõ∏ÂØæË©ï‰æ°Âûã„ÄÇÊÅãÊÑõ„ÅØÁ´∂‰∫âÊßãÈÄ†„ÅÆ‰∏ÄÁ®Æ„Å®„Åó„Å¶Ë™çË≠ò„Åï„Çå„ÇÑ„Åô„Åè„ÄÅ„Äå„ÅÇ„ÅÑ„Å§„Çà„Çä‰∏ä„Åã‰∏ã„Åã„Äç„ÅßËá™Â∞äÂøÉ„ÅåÂ§âÂãï„Åô„Çã„ÄÇÂ´âÂ¶¨„ÇíÂéüÂãïÂäõ„Å´Âä™Âäõ„Åô„ÇãÈù¢„ÇÇ„ÅÇ„Çã„Åå„ÄÅÂÆâÂøÉ„Åß„Åç„ÇãÊôÇÈñì„ÅåÁü≠„ÅÑ„ÄÇÂ∏∏„Å´Ë™∞„Åã„ÅÆÂ≠òÂú®„ÇíÂèÇÁÖß„ÅóÁ∂ö„Åë„Çã„Åü„ÇÅ„ÄÅÁ¥îÁ≤ã„Å™Ê≤°ÂÖ•„ÅåÈõ£„Åó„ÅÑ„ÄÇ' },
  mirai:     { name:'Êú™Êù•Ë™û„Çä„Åô„Åé„Çø„ÇØ„É§',     icon:'üî≠', img:'mirai.jpg',       rarity:3, phrase:'„ÄåÂ∞ÜÊù•„Åï‚Ä¶„Äç',                desc:'Èñ¢‰øÇÂàùÊúü„Åã„ÇâÂ∞ÜÊù•ÂÉè„ÇíË™û„Çä„ÄÅÁâ©Ë™û„ÇíÂä†ÈÄü„Åï„Åõ„ÇãÂâçÂÄí„ÅóÊßãÁØâÂûã„ÄÇÁèæÂÆü„ÅÆÁ©ç„ÅøÈáç„Å≠„Çà„Çä„ÇÇ"Âà∞ÈÅî‰∫àÂÆöÂú∞ÁÇπ"„ÇíÊèêÁ§∫„Åô„Çã„Åì„Å®„ÅßÂÆâÂøÉ„ÇíÂæó„Çã„ÄÇ„Éì„Ç∏„Éß„É≥ÊèêÁ§∫Âäõ„ÅØÈ´ò„ÅÑ„Åå„ÄÅÁèæÂú®„ÅÆÊÑüÊÉÖÁ¢∫Ë™ç„ÅåÁñé„Åã„Å´„Å™„Çä„ÇÑ„Åô„ÅÑ„ÄÇÊú™Êù•„ÅÆ‰øùË®º„ÇíË™û„Çã„Åª„Å©„ÄÅË∂≥ÂÖÉ„ÅÆ‰∏çÂÆâ„ÅåÈÄè„Åë„Çã‰∫åÈáçÊßãÈÄ†„ÇíÊåÅ„Å§„ÄÇ' },
  kidoku:    { name:'Êó¢Ë™≠Âì≤Â≠¶„Çø„ÇØ„É§',         icon:'üî¨', img:'kidoku.jpg',      rarity:4, phrase:'„Äå3ÂàÜÁ©∫„ÅÑ„Åü„ÅÆ„ÅØ‰ΩïÔºü„Äç',       desc:'„É°„ÉÉ„Çª„Éº„Ç∏„ÅÆÊó¢Ë™≠„ÉªÊú™Ë™≠„ÉªÈñìÈöî„ÇíÊÑèÂë≥Ë´ñÁöÑ„Å´Ëß£Êûê„Åô„ÇãÈÅéÂâ∞Ëß£ÈáàÂûã„ÄÇ„ÉÜ„Ç≠„Çπ„Éà‰∏ä„ÅÆÂæÆÂ∑Æ„ÇíÊÑüÊÉÖÊåáÊ®ô„Å®„Åó„Å¶Êâ±„ÅÑ„ÄÅ„Åù„Åì„Åã„ÇâÈñ¢‰øÇÊÄß„ÅÆÊé®Áßª„ÇíÊé®Ê∏¨„Åô„Çã„ÄÇÊ¥ûÂØüÂäõ„ÅØÈã≠„ÅÑ„Åå„ÄÅËß£Èáà„ÅÆÊö¥Ëµ∞„Åå‰∏çÂÆâ„ÇíÂ¢óÂπÖ„Åï„Åõ„Çã„Åì„Å®„ÇÇÂ§ö„ÅÑ„ÄÇÊÅãÊÑõ„Çí"„Éá„Éº„ÇøËß£ÊûêÂØæË±°"„Å®„Åó„Å¶Êâ±„ÅÜÁü•ÊÄßÊ¥æ‰∏çÂÆâÂûã„ÄÇ' },
  jikokei:   { name:'Ëá™Â∑±ÂïìÁô∫Ë¶öÈÜí„Çø„ÇØ„É§',     icon:'üî•', img:'jikokei.png',     rarity:2, phrase:'„Äå‰ø∫„ÄÅÂ§â„Çè„Çã„Çè„Äç',            desc:'Â§±ÊÅã„ÇÑÊãíÁµ∂„ÇíÂ•ëÊ©ü„Å´ÊÄ•ÊøÄ„Å™Ëá™Â∑±ÊîπÈù©„Å∏Ëµ∞„ÇãÂÜçÊßãÁØâÂûã„ÄÇÁ≠ã„Éà„É¨„ÉªË™≠Êõ∏„ÉªÂâØÊ•≠„Å™„Å©ÂèØË¶ñÂåñÂèØËÉΩ„Å™ÊàêÈï∑„Å∏ÈõÜ‰∏≠„Åó„ÄÅÊÑüÊÉÖ„ÅÆÁóõ„Åø„ÇíÊàêÊûú„Å∏Â§âÊèõ„Åô„Çã„ÄÇË°åÂãïÂäõ„ÅØÈ´ò„ÅÑ„Åå„ÄÅÂÜÖÈù¢ÁöÑ„Å™Âá¶ÁêÜ„ÅåËøΩ„ÅÑ„Å§„Åã„Å™„ÅÑÂ†¥Âêà„ÄÅÂÜç„Å≥ÂêåÊßò„ÅÆÊßãÂõ≥„ÇíÁπ∞„ÇäËøî„ÅôÂÇæÂêë„ÇÇ„ÅÇ„Çã„ÄÇÊÅãÊÑõ„ÇíËá™Â∑±ÈçõÈå¨„ÅÆ„Éà„É™„Ç¨„Éº„Å®„Åô„Çã„Çø„Ç§„Éó„ÄÇ' },
  mutteki:   { name:'ÁÑ°Êïµ„É¢„Éº„ÉâÂÆ£Ë®Ä„Çø„ÇØ„É§',   icon:'üõ°Ô∏è', img:'mutteki.jpg',     rarity:3, phrase:'„ÄåÂà•„Å´„ÇÇ„ÅÜ„ÅÑ„ÅÑ„Åó„Äç',          desc:'„Äå„ÇÇ„ÅÜ‰Ωï„ÇÇÊúüÂæÖ„Åó„Å™„ÅÑ„Äç„Å®„ÅÑ„ÅÜÂÆ£Ë®Ä„Å´„Çà„ÇäÂøÉÁêÜÁöÑÂÑ™‰Ωç„ÇíÁ¢∫‰øù„Åó„Çà„ÅÜ„Å®„Åô„ÇãÊí§ÈÄÄÂÅΩË£ÖÂûã„ÄÇÁÑ°Èñ¢ÂøÉ„ÇíË£Ö„ÅÜ„Åå„ÄÅÂÆüÈöõ„Å´„ÅØ‰æùÁÑ∂„Å®„Åó„Å¶Âº∑„ÅÑÊ∏áÊúõ„ÇíÂÜÖÂú®„Åó„Å¶„ÅÑ„Çã„ÄÇÊúüÂæÖ„Çí‰∏ã„Åí„Çã„Åì„Å®„ÅßÂÇ∑„ÇíÊúÄÂ∞èÂåñ„Åô„Çã„Åå„ÄÅÂêåÊôÇ„Å´ÂèØËÉΩÊÄß„ÇÇÁã≠„ÇÅ„Å¶„Åó„Åæ„ÅÜ„ÄÇÈÅîË¶≥„Å®Ë´¶Ë¶≥„ÅÆÂ¢ÉÁïåÁ∑ö„ÇíÊ≠©„ÅèÈò≤Ë°õÁöÑ„É©„Éñ„Çø„Ç§„Éó„ÄÇ' }
};

// ==============================
// QUESTIONS
// ==============================
const ALL_QUESTIONS = [
  {
    text: 'Â•Ω„Åç„Å™‰∫∫„Åã„Çâ3ÊôÇÈñìËøî‰ø°„Åå„Å™„ÅÑ„ÄÇ„Å©„ÅÜ„Åô„ÇãÔºü',
    scenario: 'Êó¢Ë™≠„ÇÇ„Å§„Åã„Å™„ÅÑ„ÄÇ„Åì„ÅÆ3ÊôÇÈñì„ÄÅ„Å©„ÅÜÈÅé„Åî„ÅôÔºü',
    options: [
      { text:'„Äå„Åì„ÅÆ3ÊôÇÈñì„Å´Áµ∂ÂØæÊÑèÂë≥„Åå„ÅÇ„Çã„Äç„Å®Ëß£Êûê„ÇíÂßã„ÇÅ„Çã', type:'kidoku' },
      { text:'„ÄåÂà•„Å´Ê∞ó„Å´„Åó„Å¶„Å™„ÅÑ„Åó„Äç„Å®Ëá™ÂàÜ„Å´Ë®Ä„ÅÑËÅû„Åã„Åõ„Çã', type:'mutteki' },
      { text:'„Äå‰ø∫„ÅÆ„Åì„Å®Â´å„ÅÑ„Å´„Å™„Å£„ÅüÔºü„Äç„Å®‰∏çÂÆâ„Åß„ÅÑ„Å£„Å±„ÅÑ', type:'shoninbaku' },
      { text:'Ê∫ú„ÇÅËæº„Çì„Åß„ÄÅ„ÅÇ„ÇãÊó•Á™ÅÁÑ∂ÂÖ®ÈÉ®Âêê„ÅçÂá∫„Åô', type:'atfield' }
    ]
  },
  {
    text: 'Â§±ÊÅã„Åó„ÅüÁøåÊúù„ÄÅÊúÄÂàù„Å´„Åô„Çã„Åì„Å®',
    scenario: 'ÊåØ„Çâ„Çå„ÅüÁøåÊó•„ÅÆÊúù„ÄÅÁõÆ„ÅåË¶ö„ÇÅ„Åü„ÄÇ„ÅÇ„Å™„Åü„ÅØÔºü',
    options: [
      { text:'SNS„Å´Ë©©ÁöÑ„Å™ÊñáÁ´†„ÇíÊäïÁ®ø„Åô„Çã', type:'poemer' },
      { text:'„Äå‰ø∫„ÄÅÂ§â„Çè„Çã„Çè„Äç„Å®„Ç∏„É†„Å´ÂÖ•‰ºö„Åô„Çã', type:'jikokei' },
      { text:'Áõ∏Êâã„ÅÆInstagram„Çí„Å≤„Åü„Åô„Çâ„ÉÅ„Çß„ÉÉ„ÇØ„Åô„Çã', type:'jyurei' },
      { text:'„Äå„Å©„ÅÜ„Åõ‰ø∫„Å™„Çì„Å¶‚Ä¶„Äç„Å®Ëá™Â∑±Âçë‰∏ã„Åô„Çã', type:'unko' }
    ]
  },
  {
    text: 'Á™ÅÁÑ∂„ÄåÂ•Ω„Åç„Åß„Åô„Äç„Å®Ë®Ä„Çè„Çå„Åü„ÄÇÊ≠£Áõ¥„Å™ÂèçÂøú„ÅØÔºü',
    scenario: '‰∫àÊúü„Åõ„ÅöÂëäÁôΩ„Åï„Çå„ÅüÁû¨Èñì',
    options: [
      { text:'„Å™„Åú„ÅãÁ¥†Áõ¥„Å´Âñú„Åπ„Åö„ÄÅÂÜ∑Èùô„Å´ÁêÜÂ±à„Çí„Åì„Å≠„Çã', type:'udegumi' },
      { text:'„Äå„Åì„Çå„ÅØÈÅãÂëΩ„ÅÆÂá∫‰ºö„ÅÑ„Å†„Äç„Å®ÊÑü„Åò„Çã', type:'poemer' },
      { text:'„Åô„Åê„Å´È†≠„ÅÆ‰∏≠„ÅßÁõ∏Êâã„ÅÆÁêÜÊÉ≥ÂÉè„Çí‰Ωú„ÇäÂßã„ÇÅ„Çã', type:'risou' },
      { text:'„Äå‰∏ªÂ∞éÊ®©„ÇíÂèñ„Çâ„Çå„Åü„Äç„Å®ÊÑü„Åò„Å¶„Åó„Åæ„ÅÜ', type:'udegumi' }
    ]
  },
  {
    text: 'ÊÅãÊÑõ‰∏≠„ÅÆ„ÅÇ„Å™„Åü„Çí‰∏ÄË®Ä„ÅßË°®„Åô„Å®Ôºü',
    scenario: 'Ë¶™„Åó„ÅÑÂèã‰∫∫„Å´ËÅû„Åã„Çå„Åü„Å®„Åç',
    options: [
      { text:'Áõ∏Êâã„ÅÆË∂£Âë≥„ÉªÂè£Ë™ø„Éª„É™„Ç∫„É†„Åæ„ÅßÊüì„Åæ„Å£„Å¶„ÅÑ„Åè', type:'mutation' },
      { text:'„Éá„Éº„Éà„ÅßËá™ÁÑ∂„Å®2„Äú3Âπ¥Âæå„ÅÆË©±„Çí„Åó„Å¶„Çã', type:'mirai' },
      { text:'„Äå„ÅÇ„ÅÆ‰∫∫„Çà„Çä‰ø∫„ÅÆÊñπ„Åå„ÅÑ„ÅÑ„Çà„Å™„Äç„Å®ÊØî„Åπ„Å¶„Çã', type:'hikaku' },
      { text:'LINE„ÅÆËøî‰ø°ÈÄüÂ∫¶„Å´‰∏ÄÂñú‰∏ÄÊÜÇ„Åó„Å¶„ÅÑ„Çã', type:'shoninbaku' }
    ]
  },
  {
    text: 'ÊÅãÊÑõ„Åß‰∏ÄÁï™Â§ß‰∫ã„Å´„Åó„Å¶„ÅÑ„Çã„Åì„Å®',
    scenario: '„ÅÇ„Å™„Åü„ÅåÁÑ°ÊÑèË≠ò„Å´ÂÑ™ÂÖà„Åó„Å¶„ÅÑ„Çã„ÇÇ„ÅÆ',
    options: [
      { text:'„ÄåÂ•Ω„Åç„Äç„Å®„ÅÑ„ÅÜË®ºÊã†„ÉªË®ºÊòé„ÇíÈõÜ„ÇÅ„Çã„Åì„Å®', type:'shoninbaku' },
      { text:'„Åì„ÅÆÈñ¢‰øÇ„ÅåÊåÅ„Å§"ÊÑèÂë≥"„ÇÑ"Áâ©Ë™û"„Å®„Åó„Å¶„ÅÆ‰æ°ÂÄ§', type:'poemer' },
      { text:'Âë®„Çä„ÅÆË™∞„Çà„ÇäËá™ÂàÜ„Åå„ÅÜ„Åæ„Åè„ÅÑ„Å£„Å¶„ÅÑ„Çã„Åì„Å®', type:'hikaku' },
      { text:'„Äå‰ªä„ÅØÊ∫ñÂÇôÊúüÈñì„Äç„ÄÅ„ÇÇ„Å£„Å®ËâØ„Åè„Å™„Å£„Å¶„Åã„ÇâÂãï„Åè', type:'jobhopper' }
    ]
  },
  {
    text: 'ËêΩ„Å°Ëæº„Çì„Åß„ÅÑ„Çã„Å®„Åç„ÄÅÂ•Ω„Åç„Å™‰∫∫„ÅÆÂâç„Åß„Å©„ÅÜÊåØ„ÇãËàû„ÅÜÔºü',
    scenario: 'Á≤æÁ•ûÁöÑ„Å´„Åó„Çì„Å©„ÅÑÊôÇÊúü„Å´‰ºö„ÅÜÂ†¥Èù¢',
    options: [
      { text:'„Äå„Å°„Çá„Å£„Å®ÂÇ∑„Å§„ÅÑ„Å¶„Çã„Çì„Å†„Çà„Å≠‚Ä¶„Äç„Å®Âº±„Åï„ÇíË¶ã„Åõ„Çã', type:'hamchan' },
      { text:'ÊôÆÈÄö„Å´„Åó„Å¶„Åü„ÅÆ„Å´ÊÄ•„Å´„Äå‰ø∫„Åï„ÄÅÂÆü„ÅØ‚Ä¶„Äç„Å®Ê∑±„ÅÑË©±', type:'atfield' },
      { text:'„Äå‰ø∫„Åì„Çì„Å™„Çì„Å†„Å£„ÅëÔºü„Äç„Å®Ëá™ÂàÜ„ÇíË¶ãÂ§±„Å£„Å¶„ÅÑ„Çã', type:'mutation' },
      { text:'„Äå„Å©„ÅÜ„Åõ‰ø∫„ÅØ„Åù„ÅÜ„ÅÑ„ÅÜ„ÇÑ„Å§„Å†„Åã„Çâ„Äç„Å®Ëá™Ëôê„Åô„Çã', type:'unko' }
    ]
  },
  {
    text: 'Â•Ω„Åç„Å™‰∫∫„ÅåÂà•„ÅÆÁï∞ÊÄß„Å®Ê•Ω„Åó„Åù„ÅÜ„ÄÇ„Å©„ÅÜÂèçÂøú„Åô„ÇãÔºü',
    scenario: 'SNS„Åß„Åù„ÅÆÂ†¥Èù¢„ÇíÁô∫Ë¶ã„Åó„Å¶„Åó„Åæ„Å£„Åü',
    options: [
      { text:'„Äå„Åµ„Éº„Çì„Äç„Å®Âëü„Åç„Å™„Åå„ÇâÁîªÈù¢„ÇíÈñâ„Åò„Çã', type:'jyurei' },
      { text:'„Äå„ÅÇ„ÅÑ„Å§„Çà„Çä‰ø∫„ÅÆÊñπ„ÅåÂãù„Å£„Å¶„Çã„Äç„Å®Á¢∫Ë™ç‰ΩúÊ•≠', type:'hikaku' },
      { text:'„ÄåÂà•„Å´„ÇÇ„ÅÜ„ÅÑ„ÅÑ„Åó„Äç„Å®Âº∑„Åå„Çã', type:'mutteki' },
      { text:'‰Ωï„ÇÇË®Ä„Çè„Å™„ÅÑ„Åå„ÄÅÂÜÖÂøÉ„Åö„Å£„Å®„É¢„É§„É¢„É§„Åó„Å¶„ÅÑ„Çã', type:'jyurei' }
    ]
  },
  {
    text: '„Äå„Åù„Çç„Åù„ÇçÈñ¢‰øÇ„Çí„ÅØ„Å£„Åç„Çä„Åï„Åõ„Çà„ÅÜ„Äç„Å®Ë®Ä„Çè„Çå„Åü',
    scenario: 'Â•Ω„Åç„Å™‰∫∫„Å´Ë©∞„ÇÅ„Çâ„Çå„ÅüÁä∂Ê≥Å',
    options: [
      { text:'„Äå„ÅÑ„ÇÑÈÅï„Åè„Å¶„ÄÅ„Åù„ÅÜ„ÅÑ„ÅÜË©±„Åò„ÇÉ„Å™„Åè„Å¶„Äç„Å®Ë´ñÁÇπ„Çí„Åö„Çâ„Åô', type:'udegumi' },
      { text:'„Äå‰ªä„Å°„Çá„ÅÜ„Å©„Éï„Çß„Éº„Ç∫Â§â„Çè„Å£„Å¶„Å¶„Äç„Å®ÂÖàÈÄÅ„Çä', type:'jobhopper' },
      { text:'„ÄåÂ∞ÜÊù•ÁöÑ„Å´„ÅØ‚Ä¶„Äç„Å®Êú™Êù•„ÅÆË©±„Å´„Åô„ÇäÊõø„Åà„Çã', type:'mirai' },
      { text:'„Äå‰ø∫„Åå„ÇÇ„Å£„Å®„Å°„ÇÉ„Çì„Å®„Åó„Å¶„Çå„Å∞„Äç„Å®Ëá™Ëôê„Åô„Çã', type:'unko' }
    ]
  },
  {
    text: 'ÈÅéÂéª„ÅÆËá™ÂàÜ„ÅÆÊÅãÊÑõ„Éë„Çø„Éº„É≥„ÄÅ„Å©„Çå„Å´Ëøë„ÅÑÔºü',
    scenario: 'ÈÅéÂéª„ÅÆÊÅãÊÑõ„ÇíÊåØ„ÇäËøî„Å£„Å¶',
    options: [
      { text:'ÊÑüÊÉÖ„ÇíÊ∫ú„ÇÅËæº„Çì„ÅßËá®ÁïåÁÇπ„Åß‰∏ÄÊ∞ó„Å´Ëá™Â∑±ÈñãÁ§∫„Åô„Çã', type:'atfield' },
      { text:'Â•Ω„Åç„Å™‰∫∫„Å´Âêà„Çè„Åõ„Å¶Ëá™ÂàÜ„ÅÆÂÖ®„Å¶„ÅåÂ§â„Çè„Å£„Å¶„ÅÑ„Åè', type:'mutation' },
      { text:'LINE„ÅÆÊó¢Ë™≠„ÉªÈñìÈöî„ÉªÊñá‰Ωì„ÇíÂÖ®Âäõ„ÅßËß£Êûê„Åó„Å¶„ÅÑ„Çã', type:'kidoku' },
      { text:'„Äå„ÅÇ„ÅÆÈ†É„ÅÆ‰∫å‰∫∫„ÅØÁâπÂà•„Å†„Å£„Åü„Äç„Å®Ë™û„ÇäÁ∂ö„Åë„Çã', type:'poemer' }
    ]
  },
  {
    text: 'ÁêÜÊÉ≥„ÅÆËá™ÂàÜ„ÅÆ„Ç§„É°„Éº„Ç∏„Å´Ëøë„ÅÑ„ÅÆ„ÅØÔºü',
    scenario: 'ÊÅãÊÑõ„Å´„Åä„Åë„Çã„Äå„Å™„Çä„Åü„ÅÑËá™ÂàÜÂÉè„Äç',
    options: [
      { text:'Ë™∞„Åã„Å´ÂÆà„Å£„Å¶„ÇÇ„Çâ„Åà„Çã„ÄÅÊÑõ„Åï„Çå„ÇãÂ∞èÂãïÁâ©ÁöÑ„Å™Â≠òÂú®', type:'hamchan' },
      { text:'Â§±ÊÅã„Çí‰πó„ÇäË∂ä„Åà„Å¶ÂäáÁöÑ„Å´ÊàêÈï∑„Åó„ÅüÁî∑', type:'jikokei' },
      { text:'Ë∂ÖÁÑ∂„Å®„Åó„Å¶„ÄÅ‰Ωï„ÇÇÊúüÂæÖ„Åõ„Åö„Å´Áîü„Åç„Å¶„ÅÑ„Çã‰∫∫', type:'mutteki' },
      { text:'Ë™∞„Çà„Çä„ÇÇ„Åù„ÅÆ‰∫∫„ÅÆ„Åì„Å®„Çí„Çè„Åã„Å£„Å¶„ÅÑ„ÇãÂ≠òÂú®', type:'jyurei' }
    ]
  }
];

// ==============================
// STATE
// ==============================
let currentQ = 0;
let shuffledQs = [];
let scores = {};
let prevScreen = 'screen-top';

function resetScores() {
  Object.keys(TYPES).forEach(k => scores[k] = 0);
}

function shuffle(arr) {
  const a = [...arr];
  for (let i = a.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [a[i], a[j]] = [a[j], a[i]];
  }
  return a;
}

// ==============================
// SCREEN
// ==============================
function showScreen(id) {
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  const el = document.getElementById(id);
  el.classList.remove('active');
  void el.offsetWidth;
  el.classList.add('active');
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

// ==============================
// QUIZ
// ==============================
function startQuiz() {
  resetScores();
  currentQ = 0;
  shuffledQs = shuffle(ALL_QUESTIONS);
  showScreen('screen-quiz');
  renderQ();
}

function renderQ() {
  const q = shuffledQs[currentQ];
  const n = currentQ + 1;
  const total = shuffledQs.length;
  const labels = ['A', 'B', 'C', 'D', 'E'];

  document.getElementById('q-counter').textContent = `Q ${String(n).padStart(2,'0')} / ${total}`;
  document.getElementById('q-num-label').textContent = `QUESTION ${String(n).padStart(2,'0')}`;
  document.getElementById('progress-fill').style.width = `${((n-1) / total) * 100}%`;
  document.getElementById('q-text').textContent = q.text;
  document.getElementById('q-scenario').textContent = q.scenario;

  const list = document.getElementById('options-list');
  list.innerHTML = '';

  // Shuffle A-D options, then append E
  const shuffledOpts = shuffle(q.options);
  const allOpts = [
    ...shuffledOpts,
    { text: '„Çè„Åã„Çì„Å™„ÅÑ‚Ä¶', type: 'wakaranai', isE: true }
  ];

  allOpts.forEach((opt, i) => {
    const btn = document.createElement('button');
    btn.className = 'option-btn' + (opt.isE ? ' opt-e' : '');
    btn.innerHTML = `<span class="opt-tag">${labels[i]}</span><span class="opt-text">${opt.text}</span>`;
    btn.addEventListener('click', () => choose(btn, opt.type));
    list.appendChild(btn);
  });
}

function choose(btn, type) {
  document.querySelectorAll('.option-btn').forEach(b => b.style.pointerEvents = 'none');
  btn.classList.add('selected');
  scores[type] = (scores[type] || 0) + 1;
  setTimeout(() => {
    currentQ++;
    if (currentQ < shuffledQs.length) {
      showScreen('screen-quiz');
      renderQ();
    } else {
      showScreen('screen-loading');
      setTimeout(showResult, 2000);
    }
  }, 400);
}

// ==============================
// RESULT
// ==============================
function showResult() {
  const sorted = Object.entries(scores).sort((a,b) => b[1]-a[1]);
  const [topKey, topScore] = sorted[0];
  const t = TYPES[topKey];
  const total = shuffledQs.length;

  const imgEl = document.getElementById('result-img');
  imgEl.src = 'images/' + t.img;
  imgEl.alt = t.name;
  imgEl.style.transform = 'scale(0)';
  void imgEl.offsetWidth;
  imgEl.style.animation = 'none';
  void imgEl.offsetWidth;
  imgEl.style.animation = '';

  const starsEl = document.getElementById('result-stars');
  starsEl.innerHTML = '';
  for (let i = 1; i <= 5; i++) {
    const s = document.createElement('span');
    s.className = i <= t.rarity ? 's1' : 's0';
    s.textContent = '‚òÖ';
    starsEl.appendChild(s);
  }

  const intensity = topScore >= 4 ? 'ÂÆåÂÖ®„Å´' : topScore >= 3 ? '„Åã„Å™„Çä' : topScore >= 2 ? '„Å©„Å°„Çâ„Åã„Å®„ÅÑ„Åà„Å∞' : '„Å°„Çá„Å£„Å¥„Çä';
  document.getElementById('result-intensity').textContent = intensity;
  document.getElementById('result-name').textContent = t.name;
  document.getElementById('result-phrase').textContent = t.phrase;
  document.getElementById('result-desc').textContent = t.desc;

  const pct = Math.round((topScore / total) * 100);
  document.getElementById('score-pct').textContent = `${pct}%`;

  showScreen('screen-result');
  setTimeout(() => {
    document.getElementById('score-bar').style.width = Math.max(pct, 15) + '%';
  }, 100);

  const runners = sorted.slice(1,4).filter(([,v]) => v > 0);
  const mixEl = document.getElementById('mix-wrap');
  if (runners.length) {
    mixEl.innerHTML = `
      <div class="mix-title">MIX IN YOUR DNA</div>
      <div class="mix-tags">${runners.map(([k]) => `<span class="mix-tag">${TYPES[k].icon} ${TYPES[k].name}</span>`).join('')}</div>
    `;
  } else {
    mixEl.innerHTML = '';
  }
}

// ==============================
// ALL TYPES
// ==============================
function showAllTypes() {
  prevScreen = document.querySelector('.screen.active').id;
  document.getElementById('all-grid').innerHTML = Object.entries(TYPES).map(([,t]) => `
    <div class="type-card">
      <div class="tc-top">
        <span class="tc-icon">${t.icon}</span>
        <span class="tc-rarity">${'‚òÖ'.repeat(t.rarity)}${'‚òÜ'.repeat(5-t.rarity)}</span>
      </div>
      <div class="tc-name">${t.name}</div>
      <div class="tc-phrase">${t.phrase}</div>
    </div>
  `).join('');
  showScreen('screen-all');
}

function goBack() { showScreen(prevScreen); }
function retryQuiz() { startQuiz(); }

function shareResult() {
  const sorted = Object.entries(scores).sort((a,b) => b[1]-a[1]);
  const t = TYPES[sorted[0][0]];
  const text = `„Äê„Çø„ÇØ„Çø„Ç§„ÉóË®∫Êñ≠„Äë\nÁßÅ„ÅØ„Äå${t.name}„Äç„Åß„Åó„ÅüÔºÅ\nÂè£ÁôñÔºö${t.phrase}\n\n#„Çø„ÇØ„Çø„Ç§„ÉóË®∫Êñ≠`;
  if (navigator.clipboard) {
    navigator.clipboard.writeText(text).then(() => showToast('ÁµêÊûú„Çí„Ç≥„Éî„Éº„Åó„Åæ„Åó„ÅüÔºÅ'));
  } else {
    showToast('„Ç≥„Éî„Éº„Åß„Åç„Åæ„Åõ„Çì„Åß„Åó„Åü');
  }
}

function showToast(msg) {
  const el = document.getElementById('toast');
  el.textContent = msg;
  el.classList.add('show');
  setTimeout(() => el.classList.remove('show'), 2500);
}
</script>
</body>
</html>
